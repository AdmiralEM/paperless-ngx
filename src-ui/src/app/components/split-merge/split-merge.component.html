<app-page-header i18n-title title="Split & Merge Editor">
  <div class="btn-group mr-5">
    <button class="btn btn-sm btn-outline-danger" (click)="cancel()">
      <svg width="1em" height="1em" viewBox="0 0 16 16" fill="currentColor">
        <use xlink:href="assets/bootstrap-icons.svg#slash-circle" />
      </svg>&nbsp;<ng-container i18n>Cancel</ng-container>
    </button>
  </div>

  <div class="btn-group ml-5">
    <button class="btn btn-sm btn-outline-primary" (click)="save()" [disabled]="splitMergeService.getDocuments().length < 1">
      <svg width="1em" height="1em" viewBox="0 0 16 16" fill="currentColor">
        <use xlink:href="assets/bootstrap-icons.svg#check-circle" />
      </svg>&nbsp;<ng-container i18n>Save</ng-container>
    </button>
  </div>
</app-page-header>

<div class="row">
  <div class="col-6">
    <div class="btn-toolbar" role="toolbar">
      <div class="btn-group btn-group-toggle" ngbRadioGroup name="modeRadio" [(ngModel)]="mode" (change)="onModeChange()">
        <label ngbButtonLabel class="btn-sm btn-outline-primary">
          <input ngbButton type="radio" value="merge">
          <svg width="1em" height="1em" viewBox="0 0 16 16" fill="currentColor">
            <use xlink:href="assets/bootstrap-icons.svg#arrows-angle-contract" />
          </svg>&nbsp;<ng-container i18n>Merge</ng-container>
        </label>
        <label ngbButtonLabel class="btn-sm btn-outline-primary">
          <input ngbButton type="radio" value="split">
          <svg width="1em" height="1em" viewBox="0 0 16 16" fill="currentColor">
            <use xlink:href="assets/bootstrap-icons.svg#arrows-angle-expand" />
          </svg>&nbsp;<ng-container i18n>Split</ng-container>
        </label>
      </div>
      <button class="btn btn-sm btn-outline-primary ml-auto" (click)="chooseDocuments()">
        <svg width="1em" height="1em" viewBox="0 0 16 16" fill="currentColor">
          <use xlink:href="assets/bootstrap-icons.svg#plus-circle" />
        </svg>&nbsp;{{addDocumentButtonTitle}}
      </button>
    </div>
    <div class="py-4" dndDropzone (dndDrop)="onDrop($event, documents)">
      <div class="spacer bg-primary" dndPlaceholderRef>
      </div>
      <div *ngFor="let d of documents; let i = index" class="card w-100 mb-3" [dndDraggable]="d" dndEffectAllowed="move" (dndMoved)="onDragged(d, documents)">
        <div class="row no-gutters">
          <div class="col-md-4">
            <img class="card-img" [src]="getThumbUrl(d.id)">
          </div>
          <div class="col-md-8">
            <div class="card-body p-3">
              <h6 class="card-title mb-3">{{d.title}}</h6>
              <div class="card-actions">
                <div class="btn-group btn-group-sm mb-3 w-100">
                  <button class="btn btn-sm btn-outline-danger" title="Remove" (click)="removeDocument(d, i)">
                    <svg width="1em" height="1em" viewBox="0 0 16 16" fill="currentColor">
                      <use xlink:href="assets/bootstrap-icons.svg#trash" />
                    </svg>&nbsp;<ng-container i18n>Remove</ng-container>
                  </button>
                  <button *ngIf="mode == 'merge'" class="btn btn-sm btn-outline-primary" title="Duplicate" (click)="duplicateDocument(d, i)">
                    <svg width="1em" height="1em" viewBox="0 0 16 16" fill="currentColor">
                      <use xlink:href="assets/bootstrap-icons.svg#files" />
                    </svg>&nbsp;<ng-container i18n>Duplicate</ng-container>
                  </button>
                </div>
                <div class="input-group input-group-sm w-100">
                  <div class="input-group-prepend">
                    <div class="input-group-text">{{pagesInputLabel}}:</div>
                  </div>
                  <input class="form-control" placeholder="All" ngbTooltip="e.g. 1-3,5" />
                  <div class="input-group-append">
                    <button class="btn btn-outline-primary" type="button" (click)="choosePages(d)">
                      <svg width="1em" height="1em" viewBox="0 0 16 16" fill="currentColor">
                        <use xlink:href="assets/bootstrap-icons.svg#pencil" />
                      </svg>&nbsp;<ng-container i18n>Select Pages</ng-container>
                    </button>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
  <div class="col-6 preview-container text-center bg-light">
    <h6 class="my-2 text-muted" i18n>Preview</h6>
    <div *ngIf="loading" class="spinner-border" role="status">
      <span class="sr-only" i18n>Loading...</span>
    </div>
    <pdf-viewer *ngIf="previewUrl" [src]="previewUrl" [original-size]="false" [show-borders]="true" [show-all]="true" [render-text-mode]="2" (after-load-complete)="pdfPreviewLoaded($event)"></pdf-viewer>
  </div>
</div>
